## Примечания
### 1
- в карточке дома можно посмотреть список квартир, относящихся к дому и сразу перейти в нужную
  кликнув на ссылку
- в карточке квартиры можно посмотреть список счетчиков, относящихся к квартире
- список квартир можно сортировать также по площади и дому
- список квартир можно фильтровать по дому
- доавлена модель для создания типов счетчиков (ХВС, ГВС и т.д.)
- для простоты выполнения тестового задания показания счетчика должны иметь вид:
{
    "2024-01": 120.5,
    "2024-02": 135.7,
    "2024-03": 142.9
}
- счетчики можно фильтровать по квартире и по дому
- при добавлении тарифа можно выбрать либо тип счетчика, либо указать название:
  - если выбран тип счетчика, то необходимо указать только цену. Ед. измерения автоматически подтянется из данных по счетчику
  - если указать название, то необходимо указать и единицу измерения

### 2

Роуты доступны авторизованным и неавторизованным пользователям, поскольку в ТЗ данного условия не было

Реализовано следующее API
 - ++ 'api/house/<int:id>' данные по опр. дому ( содержит адрес, список квартир, список счетчиков внутри квартиры)
 - ++ 'api/houses' список всех домов
 - ++ api/apartment/<int:id>/ данные по квартире
 - ++ 'api/meters/house/<int:house_id>/' (api/meters/house/<int:house_id>/?apartment_id=flat_id) список счетчиков для опр. дома с возможностью фильтрации по квартире
 - ++ api/meters/<int:id>/ данные по опр счетчику
 - ++ 'api/houses' добавление домов
 - ++ api/apartments/ добавление квартир
 - ++ api/meters/ добавление счетчиков
 - ++ 'api/houses/<int:id>/' редактирование дома
 - ++ api/apartment/<int:id>/редактирование квартиры
 - ++ api/meter/<int:id>/ редактирование счетчика
 - ++ api/meter-types получение типов счетчиков
 - ++ 'api/house/<int:house_id>/calculate_bills/' запуск расчета квартплаты для опр дома
 - ++ 'api/tasks/<str:task_id>/result/' статус расчета квартплаты и результат

### 3

Доп.опции:
- если счетчик установлен в квартире (есть данные о нем)
  - для первого измерения счетчика, данные за предыдущий период равны 0
  - если отсутствуют показания за текущий месяц (кроме начального), но счетчик был установлен, мы будем брать средний расход за последние три месяца, 
    если такие данные есть; если данных недостаточно, то всё равно используем известные значения для расчёта среднего.
    Т.е. среднее потребление за предыдущие 3 месяца рассчитывается для случаев, когда показание пропущено, но счетчик 
    уже был установлен.
  - если показаний нет за период, который был раньше установки счетчика, то прилетает поле "absent_meters" включающее 
    список счетчиков, по которым нет данных
    ```
    "absent_meters": [
            {
                "id": 2,
                "name": "Electricity"
            }
        ]
    ```
- для расчетов, не связанных со счетчиками, исп. м2
- поддержка неограниченного расчета разных тарифов (со счетчиками и без).
- округление расчета до сотых
- формат JSON для ответа:
{
    "apartment_id": 1,
    "apartment_number": 101,
    "house_id": 1,
    "address": "123 Main Street",
    "date": "2024-08-01",
    "calc_rent": [
      {
        "id": 5,
        "name": "maintenance",
        "consumption": 45.0,
        "unit": "m2",
        "cost": 225.00
      },
      {
        "id": 2,
        "name": "Water",
        "consumption": 15.20,
        "unit": "m3",
        "cost": 30.40
      }
    ]
  },

### 4

- прогресс выполнения в рамках тестового задания имеет статусы (TaskResultView)
- поскольку кол-во данных небольшое для расчета, в запрос можно передать дополнительный пар-р (delay), который имитирует
  задержку в секундах
Порядок работы:
  - клиент отправляет запрос на 'api/house/<int:house_id>/calculate_bills/ для запуска расчета
  - клиент запрашивает переодически запрашивает статус по 'api/tasks/<str:task_id>/result/'
  - на фронте id задачи celery можно сохранить либо в LocalStorage либо в IndexedDB
  - как только задача будет завершена, в ответе кроме статуса прилетит результат расчета

### Допы

- добавлена проверка на отрицательную площадь квартиры через кастомный валидатор
- добавлена проверка на отрицательные значения для счетчика квартиры
- при добавлении счетчика с показаниями добавлена проверка:
  - отрицательное значение
  - максимум 1 месяц
  - месяц в показаниях либо текущий либо предыдущий
- редактирование показаний счетчика (максимально приближено к реальности):
  - если показаний нет, то месяц либо текущий либо предыдущий
  - если показания есть, то месяц не меньше самого раннего месяца в существующих показаниях
  - передаваться можно показания только за 1 месяц за раз
  - если уже есть запись за указанный месяц, то падает ошибка, что показания уже существуют
  - если показаний нет за указанный месяц в запросе, то вносятся показания
  - формат отправки показаний
    ```
    {"2024-06": "150"}
    ```
- автоматическое создание админа
- нельзя в


celery -A communal_task worker --loglevel=info
redis-server